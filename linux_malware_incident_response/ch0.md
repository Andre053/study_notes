# Introduction

## How to Use this Book
- Helps digital investigators identify malware on a Linux computer system
	- Collect volatile and nonvolatile system data
	- Determine impact malware makes on a subject system
- Strives to be both tactical and practical

# Investigative Approach
- Keys to a successful digital investigation
	- Organized methods
	- Sound analysis
	- Steady documentation
	- Attention to evidence dynamics

## Methodical Approach
- Five phases of investigation
	1. Forensic preservation and examination of volatile data
	2. Examination of memory
	3. Forensic analysis: examination of hard drives
	4. File profiling of an unknown file
	5. Dynamic and statis analysis of a malware specimen
- Whenever feasible, investigations should extend beyond a single compromised computer
	- Discovering other sources of evidence provide valuable information
- In addition to systems containing indicators of compromise, network and data sources are valuable
	- Backup tapes compared to current state
	- Centralized logs from antivirus agents
	- Reports from sys integrity tools
	- Netowrk, app, and db level logs
- Network forensics is a key role but not beyond the scope of this book
- Well-interviewd network admins, sys owners, and users help develop a picture of what happened
- Must ensure reliability and validity of findings
	- Consider legal requirements and limitations of access

## Forensic Soundness
- Collecting data from a live system can cause changes which need to by justified as an impact on other digital evidence
	- Any app loaded into memory changes it, losing potential data that was previously held
	- Remote tools establish a network connection, execute instructions in memory, and can make other alterations 
- Ideally, forensic acquisitions should not alter the original evidence source in any way
	- However, with proper execution, methods of acquisition can still be considered forensically sound
- Some courts consider volatile computer data discoverably, requiring preservation of data on live systems
	- Understand the view of the court you are dealing with

## Documentation
- Major key to forensic soundnress is verifiable documentation
	- Case must be built on supporting documentation which reports where evidence originated and how it was handled
	- Acquisition process should strive to change original evidence as little as possible
		- Any changes must be documented and assessed in the context of the final analytical results
	- Process preserves a complete and accurate respresentation of original data
		- Authenticity and integrity of the representation can be validated, generally results in acquisition being forensically sound
- Documentation of steps taken and results enables external evalutation and repetition of the analysis
	- Contemporaneous notes are often referred to years later to help investigators recall what occured
		- What work was done, who was interviewed, etc.
	- Common forms of documentation: screenshots, captured network traffic, output from analysis tools, notes, etc.
	- When preserving volatile data, document date and time when preserved, tools used, and calculated hash of all output
	- Note date and time of the computer and compare it with a reliable time source 
		- Time stamp information associated with acquired data

## Evidence Dynamics
- Perfect digital crime scene is rate
	- Evidence is often purposefully destroyed by deleting logs, overwriting files, or encrypting incriminating data
	- Digital investigator responds to incident only after the victim has taken initial steps to remediate
		- Victim might inadverdantly destroy evidence or compound the damage to the system
- This situation is comon in forensics, giving it the name *evidence dynamics*
- Evidence dynamics is any influence that effects evidence, regardless of intent
	- Effects can be change, relocation, obscurance, or obliteration
	- Concern in malware IR as there is often critical evidence in memory 
	- It is rare to have an opportunity to examine a digital crime scene in its original state
		- Anomalies should be expected
	- Creates investigative and legal challenges, increasing difficulty in determining what occured and proving evidence is authentic and reliable
	- Conclusions reached without knowledge of how evidence was changed may be incorrept, open to criticism in court, or misdirect the investigation
	- Aim to minimize evidence dynamics while collecting volatile data from a live system using tools which can be differentiated from similar utilities used by intruders

# Forensic Analysis in Malware Investigations
- Common analysis tasks:
	- Preservation and examination of volatile data
	- Recovery of deleted files
	- Temporal, functional, and relational kinds of digital forensic analysis

## Preservation and Examination of Volatile Data
- Heavy reliance on forensic preservation of volatile data to understand what happened
	- Minimize changes made to the system
	- Collect most volatile data first, following order of volatility (RFC 3227)
	- Thoroughly document all actions taken
- Relative importance of live system data collection
	- Tier 1 Volatile Data: Critical system details
		- Ex. Logged in users, active network connections, and running processes
	- Tier 2 Volatile Data: Ephemeral information which provides further information on the device
		- Ex. Scheduled tasks and clipboard content
	- Tier 1 Nonvolatile Data: Status, settins, and config of the target system, providing clues of methods of compromise and infection
		- Ex. Config settings and audit policy
	- Tier 2 Nonvolatile Data: Historical information and context
		- Ex. System event logs and web browser history

## Temporal, Functional, and Relational Analysis
